<link rel="import" href="../bower_components/polymer/polymer.html">

<link rel="import" href="case-list.html">
<link rel="import" href="case-detail.html">


<dom-module id="view-case">

    <template>
        <case-list list-items='{{listData}}' disable-auto-select="true" on-selected-item-changed="_updateDetails"
            sort-order="ascending">
            <template is="dom-if" if="{{!itemData}}" restamp>
                <div id="detailFallback" class="detail-fallback align-items-center d-flex h-100">
                    <div class="text-center text-muted w-100">Select an item from the list to see the details.</div>
                </div>
            </template>
            <template is="dom-if" if="{{itemData}}" restamp>
                <case-detail item-data="{{itemData}}"></case-detail>
            </template>
        </case-list>
    </template>

    <script>
        Polymer({
            is: "view-case",

            properties: {
                itemData: {
                    type: Object,
                    value: function () {
                        return null
                    }
                }
            },

            created: function () {
                /* console.log(this.localName + '#' + this.id + ' was created'); */
                document.documentElement.classList.remove('in-progress');
            },

            ready: function () {
                /* console.log(this.localName + '#' + this.id + ' has local DOM initialized'); */

                this.listData = [
                    {
                        "id": "1",
                        "title": "Energy Per Ton NH3 Difference = 0.1",
                        "uOP2": "10 Feb 2019",
                        "uOP1": "13 Feb 2019",
                        "oppturinity": 2,
                        "type": "red",
                        "caseStudy": "For the same feed/fuel ratio of 4.04 there\nis an additional methane slip of 0.033 from the secondary reformer due to\nreduced primary and secondary reformer outlet temperature ",
                        "dataTable": [
                            {
                                "timestampStart": "10/02/2019 6:31",
                                "TotalGasInput": 4319,
                                "TotalNGFlow": 120726,
                                "AmmoniaProduction": 148.3,
                                "EnergyTonNH3": 7.35,
                                "TotalFuelFlow": 38308,
                                "FeedGasFlow": 96459,
                                "Fuelflow": 24266,
                                "Methane": 91.3,
                                "Ethane": 1.7,
                                "Propane": "0.3",
                                "Butane": "0.1",
                                "Pentane": "0",
                                "CarbonDioxide": "1.8",
                                "Nitrogen": "4.8",
                                "SCRatio": "3.09",
                                "ProcessSteamFlow": "233",
                                "PrimaryReformerOLTemp": "807",
                                "PrimaryReformerMethaneSlip": "11.51",
                                "AirFlow": "116865",
                                "SecondaryReformerOLTemp": "998",
                                "SecondaryReformerMethaneSlip": "0.37",
                                "HNRatio": "2.95",
                                "LoopPressure": "20.3",
                                "Instance": "A"

                            },
                            {
                                "timestampStart": "26/02/2019 8:31",
                                "TotalGasInput": 4319,
                                "TotalNGFlow": 121714,
                                "AmmoniaProduction": 146.4,
                                "EnergyTonNH3": 7.45,
                                "TotalFuelFlow": 37439,
                                "FeedGasFlow": 96804,
                                "Fuelflow": 24909,
                                "Methane": 91.3,
                                "Ethane": 1.4,
                                "Propane": "0.2",
                                "Butane": "0.1",
                                "Pentane": "0",
                                "CarbonDioxide": "2.1",
                                "Nitrogen": "4.9",
                                "SCRatio": "3.11",
                                "ProcessSteamFlow": "235",
                                "PrimaryReformerOLTemp": "808",
                                "PrimaryReformerMethaneSlip": "11.67",
                                "AirFlow": "116727",
                                "SecondaryReformerOLTemp": "991",
                                "SecondaryReformerMethaneSlip": "0.41",
                                "HNRatio": "2.96",
                                "LoopPressure": "20.2",
                                "Instance": "B"
                            }
                        ]
                    },
                    {
                        "id": "2",
                        "title": "Energy Per Ton NH3 Difference = 0.05",
                        "uOP2": "10 Feb 2019",
                        "uOP1": "13 Feb 2019",
                        "oppturinity": 2,
                        "type": "red",
                        "caseStudy": "For the same feed/fuel ratio of 4.03\nthere is an additional methane slip of 0.049 from the secondary reformer due to\nreduced primary and secondary reformer outlet temperature ",
                        "dataTable": [
                            {
                                "timestampStart": "13/02/2019 15:31",
                                "TotalGasInput": 4295,
                                "TotalNGFlow": 120652,
                                "AmmoniaProduction": 146.9,
                                "EnergyTonNH3": 7.38,
                                "TotalFuelFlow": 37473,
                                "FeedGasFlow": 96660,
                                "Fuelflow": 23992,
                                "Methane": 91.6,
                                "Ethane": 1.4,
                                "Propane": "0.2",
                                "Butane": "0.1",
                                "Pentane": "0",
                                "CarbonDioxide": "1.8",
                                "Nitrogen": "4.9",
                                "SCRatio": "3.07",
                                "ProcessSteamFlow": "231",
                                "PrimaryReformerOLTemp": "812",
                                "PrimaryReformerMethaneSlip": "11.98",
                                "AirFlow": "117208",
                                "SecondaryReformerOLTemp": "997",
                                "SecondaryReformerMethaneSlip": "0.39",
                                "HNRatio": "2.97",
                                "LoopPressure": "20.3",
                                "Instance": "A"

                            },
                            {
                                "timestampStart": "12/02/2019 21:01",
                                "TotalGasInput": 4295,
                                "TotalNGFlow": 120791,
                                "AmmoniaProduction": 146,
                                "EnergyTonNH3": 7.43,
                                "TotalFuelFlow": 37415,
                                "FeedGasFlow": 96802,
                                "Fuelflow": 23989,
                                "Methane": 91.5,
                                "Ethane": 1.4,
                                "Propane": "0.2",
                                "Butane": "0.1",
                                "Pentane": "0",
                                "CarbonDioxide": "1.8",
                                "Nitrogen": "5",
                                "SCRatio": "3.09",
                                "ProcessSteamFlow": "234",
                                "PrimaryReformerOLTemp": "807",
                                "PrimaryReformerMethaneSlip": "11.87",
                                "AirFlow": "116768",
                                "SecondaryReformerOLTemp": "988",
                                "SecondaryReformerMethaneSlip": "0.43",
                                "HNRatio": "2.98",
                                "LoopPressure": "20.2",
                                "Instance": "B"
                            }
                        ]
                    },

                ]
            },

            attached: function () {
                /* console.log(this.localName + '#' + this.id + ' was attached'); */
            },

            detached: function () {
                /* console.log(this.localName + '#' + this.id + ' was detached'); */
            },

            attributeChanged: function (name, type) {
                /* console.log(this.localName + '#' + this.id + ' attribute ' + name +
                    ' was changed to ' + this.getAttribute(name)); */
            },

            _updateDetails: function (e) {
                var selectedItem = e.target.listItems.find(function (item) {
                    return parseInt(item.id) === parseInt(e.detail.value);
                });
                this.set("itemData", selectedItem);
                //console.log('item', parseInt(e.detail.value), selectedItem);
            },
        });
    </script>

</dom-module>